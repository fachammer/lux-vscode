name: Lux
scopeName: source.lux
patterns:
- include: '#comments'
- include: '#strings'
- include: '#bools'
- include: '#nats'
- include: '#fractions'
- include: '#ints'
- include: '#tags'
- include: '#symbols'
- include: '#s-expressions'
- include: '#tuples'
- include: '#records'

repository:
  comments:
    patterns:
    - name: comment.line.double-hash.lux
      begin: (##)
      end: ($)
  bools:
    patterns:
    - name: constant.language.bool.lux
      match: (#0|#1)
  nats:
    patterns:
    - name: constant.numeric.nat.lux
      match: ([0-9,]+)
  ints:
    patterns:
    - name: constant.numeric.int.lux
      match: ([\+\-][0-9,]+)
  fractions:
    patterns:
    - name: constant.numeric.fraction.lux
      match: ([\+\-]([0-9,]+\.[0-9,]+))
  tags:
    patterns:
      # using constant.keyword.clojure instead of constant.tag.lux
      # to leverage existing color themes for clojure
    - name: constant.keyword.clojure
      match: (#[^\[\]\{\}\(\)\s]+(?=[\s\]\}\)]))
    - name: invalid.illegal.tag.lux
      match: (#.*)
  symbols:
    patterns:
      # using meta.symbol.clojure instead of meta.symbol.lux
      # to leverage existing color themes for clojure
    - name: meta.symbol.clojure
      match: (?<!\()([^0-9#\(\)\[\]\{\}\s][^#\(\)\[\]\{\}\s]*(?=[\)\]\}\s]))
    - name: invalid.illegal.symbol.lux
      match:  (?<!\()([^0-9#\(\)\[\]\{\}\s][^\s]*(?=[\)\]\}\s]))
  s-expressions:
    name: meta.expression.lux
    begin: (\()
    beginCaptures:
      '1':
        name: punctuation.section.expression.begin.lux
    end: (\))
    endCaptures:
      '1':
        name: punctuation.section.expression.end.trailing.lux
    patterns:
    - begin: (?<=\()\s*
      end: (?=[\s\)])
      patterns:
      - name: entity.name.function.lux
        match: ([^0-9\s][^\s\)]*)
      - include: '$self'
    - include: '$self'
  strings:
    name: string.quoted.double.lux
    begin: (")
    end: (")
    patterns:
    - name: constant.character.escape.lux
      match: (\\.)
  tuples:
    name: meta.tuple.lux
    begin: (\[)
    beginCaptures:
      '1':
        name: punctuation.section.tuple.begin.lux
    end: (\])
    endCaptures:
      '1':
        name: punctuation.section.tuple.end.lux
    patterns:
    - include: $self
  records:
    name: meta.record.lux
    begin: (\{)
    beginCaptures:
      '1':
        name: punctuation.section.record.begin.lux
    end: (\})
    endCaptures:
      '1':
        name: punctuation.section.record.end.lux
    patterns:
    - include: $self
